import{n as g,K,d as A,x,R as z,m as B,y as j,aY as le,e as i,a8 as se,a0 as D,a1 as S,ak as F,r as u,aZ as R,P as ce,N as M,O as re,D as p,a_ as ie,C as X,B as H,a$ as U,b0 as V,V as ue,p as Z,h as G,ao as W,ah as _,a4 as de,a5 as ve,F as fe,ac as ye,Y as he,H as me,aB as Ie,af as Oe,b1 as Ce}from"./index-B_wq6Ifh.js";function Se(e){const t=K();t&&g(t.proxy,e)}let xe=2e3;const Pe=()=>++xe,[be,b]=B("loading"),ge=Array(12).fill(null).map((e,t)=>i("i",{class:b("line",String(t+1))},null)),ke=i("svg",{class:b("circular"),viewBox:"25 25 50 50"},[i("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),we={size:x,type:z("circular"),color:String,vertical:Boolean,textSize:x,textColor:String};var ze=A({name:be,props:we,setup(e,{slots:t}){const n=j(()=>g({color:e.color},le(e.size))),r=()=>{const o=e.type==="spinner"?ge:ke;return i("span",{class:b("spinner",e.type),style:n.value},[t.icon?t.icon():o])},a=()=>{var o;if(t.default)return i("span",{class:b("text"),style:{fontSize:se(e.textSize),color:(o=e.textColor)!=null?o:e.color}},[t.default()])};return()=>{const{type:o,vertical:c}=e;return i("div",{class:b([o,{vertical:c}]),"aria-live":"polite","aria-busy":!0},[r(),a()])}}});const Ke=D(ze),q={show:Boolean,zIndex:x,overlay:S,duration:x,teleport:[String,Object],lockScroll:S,lazyRender:S,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:F,transitionAppear:Boolean,closeOnClickOverlay:S},je=Object.keys(q);function Te(e,t){return e>t?"horizontal":t>e?"vertical":""}function _e(){const e=u(0),t=u(0),n=u(0),r=u(0),a=u(0),o=u(0),c=u(""),l=u(!0),f=()=>c.value==="vertical",C=()=>c.value==="horizontal",d=()=>{n.value=0,r.value=0,a.value=0,o.value=0,c.value="",l.value=!0};return{move:v=>{const y=v.touches[0];n.value=(y.clientX<0?0:y.clientX)-e.value,r.value=y.clientY-t.value,a.value=Math.abs(n.value),o.value=Math.abs(r.value);const O=10;(!c.value||a.value<O&&o.value<O)&&(c.value=Te(a.value,o.value)),l.value&&(a.value>R||o.value>R)&&(l.value=!1)},start:v=>{d(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:d,startX:e,startY:t,deltaX:n,deltaY:r,offsetX:a,offsetY:o,direction:c,isVertical:f,isHorizontal:C,isTap:l}}let P=0;const N="van-overflow-hidden";function Ae(e,t){const n=_e(),r="01",a="10",o=d=>{n.move(d);const I=n.deltaY.value>0?a:r,k=ie(d.target,e.value),{scrollHeight:v,offsetHeight:y,scrollTop:O}=k;let h="11";O===0?h=y>=v?"00":"01":O+y>=v&&(h="10"),h!=="11"&&n.isVertical()&&!(parseInt(h,2)&parseInt(I,2))&&X(d,!0)},c=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",o,{passive:!1}),P||document.body.classList.add(N),P++},l=()=>{P&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",o),P--,P||document.body.classList.remove(N))},f=()=>t()&&c(),C=()=>t()&&l();ce(f),M(C),re(C),p(t,d=>{d?c():l()})}function J(e){const t=u(!1);return p(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const Y=()=>{var e;const{scopeId:t}=((e=K())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[Be,De]=B("overlay"),pe={show:Boolean,zIndex:x,duration:x,className:F,lockScroll:S,lazyRender:S,customStyle:Object,teleport:[String,Object]};var Ee=A({name:Be,inheritAttrs:!1,props:pe,setup(e,{attrs:t,slots:n}){const r=u(),a=J(()=>e.show||!e.lazyRender),o=l=>{e.lockScroll&&X(l,!0)},c=a(()=>{var l;const f=g(ue(e.zIndex),e.customStyle);return Z(e.duration)&&(f.animationDuration=`${e.duration}s`),G(i("div",_({ref:r,style:f,class:[De(),e.className]},t),[(l=n.default)==null?void 0:l.call(n)]),[[W,e.show]])});return H("touchmove",o,{target:r}),()=>{const l=i(U,{name:"van-fade",appear:!0},{default:c});return e.teleport?i(V,{to:e.teleport},{default:()=>[l]}):l}}});const Le=D(Ee),Re=g({},q,{round:Boolean,position:z("center"),closeIcon:z("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:z("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Ne,$]=B("popup");var Ye=A({name:Ne,inheritAttrs:!1,props:Re,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:r}){let a,o;const c=u(),l=u(),f=J(()=>e.show||!e.lazyRender),C=j(()=>{const s={zIndex:c.value};if(Z(e.duration)){const m=e.position==="center"?"animationDuration":"transitionDuration";s[m]=`${e.duration}s`}return s}),d=()=>{a||(a=!0,c.value=e.zIndex!==void 0?+e.zIndex:Pe(),t("open"))},I=()=>{a&&ye(e.beforeClose,{done(){a=!1,t("close"),t("update:show",!1)}})},k=s=>{t("clickOverlay",s),e.closeOnClickOverlay&&I()},v=()=>{if(e.overlay){const s=g({show:e.show,class:e.overlayClass,zIndex:c.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return i(Le,_(s,Y(),{onClick:k}),{default:r["overlay-content"]})}},y=s=>{t("clickCloseIcon",s),I()},O=()=>{if(e.closeable)return i(Ie,{role:"button",tabindex:0,name:e.closeIcon,class:[$("close-icon",e.closeIconPosition),me],classPrefix:e.iconPrefix,onClick:y},null)};let h;const Q=()=>{h&&clearTimeout(h),h=setTimeout(()=>{t("opened")})},ee=()=>t("closed"),te=s=>t("keydown",s),ne=f(()=>{var s;const{destroyOnClose:m,round:T,position:w,safeAreaInsetTop:oe,safeAreaInsetBottom:ae,show:L}=e;if(!(!L&&m))return G(i("div",_({ref:l,style:C.value,role:"dialog",tabindex:0,class:[$({round:T,[w]:w}),{"van-safe-area-top":oe,"van-safe-area-bottom":ae}],onKeydown:te},n,Y()),[(s=r.default)==null?void 0:s.call(r),O()]),[[W,L]])}),E=()=>{const{position:s,transition:m,transitionAppear:T}=e,w=s==="center"?"van-fade":`van-popup-slide-${s}`;return i(U,{name:m||w,appear:T,onAfterEnter:Q,onAfterLeave:ee},{default:ne})};return p(()=>e.show,s=>{s&&!a&&(d(),n.tabindex===0&&he(()=>{var m;(m=l.value)==null||m.focus()})),!s&&a&&(a=!1,t("close"))}),Se({popupRef:l}),Ae(l,()=>e.show&&e.lockScroll),H("popstate",()=>{e.closeOnPopstate&&(I(),o=!1)}),de(()=>{e.show&&d()}),ve(()=>{o&&(t("update:show",!0),o=!1)}),M(()=>{e.show&&e.teleport&&(I(),o=!0)}),Oe(Ce,()=>e.show),()=>e.teleport?i(V,{to:e.teleport},{default:()=>[v(),E()]}):i(fe,null,[v(),E()])}});const Fe=D(Ye);export{Ke as L,Fe as P,Se as a,je as b,q as p,_e as u};
